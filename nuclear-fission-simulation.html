<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>High-Res Nuclear Fission</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body {
            font-family: 'Pyidaungsu', 'Padauk', sans-serif;
            background-color: #0a0a12; /* Deep dark background */
            color: white;
            text-align: center;
            margin: 0;
            overflow: hidden; /* Hide scrollbars */
        }
        h1 { margin: 10px 0; color: #00d4ff; text-shadow: 0 0 10px #00d4ff; }
        .ui-panel {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 12px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
            display: flex;
            gap: 15px;
            z-index: 10;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            font-family: inherit;
            transition: 0.3s;
        }
        .btn-start { background-color: #00d4ff; color: #000; box-shadow: 0 0 10px #00d4ff; }
        .btn-start:hover { background-color: #80eaff; }
        .btn-reset { background-color: #ff4757; color: white; box-shadow: 0 0 10px #ff4757; }
        .btn-reset:hover { background-color: #ff6b81; }
        
        .stats {
            position: absolute;
            top: 20px;
            left: 20px;
            text-align: left;
            font-size: 14px;
            color: #ddd;
            line-height: 1.6;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 8px;
        }
        .stat-val { font-weight: bold; color: #ffeb3b; }
    </style>
</head>
<body>

    <h1>နူကလီးယား ဖြိုခွဲခြင်း (Nuclear Fission)</h1>

    <div class="stats">
        နူထရွန် (Neutrons): <span id="n-count" class="stat-val">0</span><br>
        ကျန်ရှိသော ယူရေနီယမ်: <span id="u-count" class="stat-val">0</span><br>
        ထုတ်လွှတ်စွမ်းအင် (Energy): <span id="e-count" class="stat-val">Low</span>
    </div>

    <div id="canvas-container"></div>

    <div class="ui-panel">
        <button class="btn-start" onclick="fireNeutron()">နူထရွန် ပစ်လွှတ်မည်</button>
        <button class="btn-reset" onclick="resetSim()">ပြန်လည်စတင်မည်</button>
    </div>

    <script>
        // Simulation Entities
        let atoms = [];
        let neutrons = [];
        let fragments = []; // Split parts (Krypton/Barium)
        let shockwaves = []; // Energy visual
        
        let reactionTriggered = false;
        let fissionCount = 0;

        function setup() {
            let canvas = createCanvas(windowWidth, windowHeight - 100);
            canvas.parent('canvas-container');
            resetSim();
        }

        function draw() {
            background(10, 10, 18); // Dark space-like background
            
            // 1. Draw Shockwaves (Energy)
            for (let i = shockwaves.length - 1; i >= 0; i--) {
                shockwaves[i].update();
                shockwaves[i].display();
                if (shockwaves[i].done()) shockwaves.splice(i, 1);
            }

            // 2. Draw Uranium Atoms
            for (let i = atoms.length - 1; i >= 0; i--) {
                atoms[i].display();
            }

            // 3. Draw Fragments (Split atoms)
            for (let f of fragments) {
                f.update();
                f.display();
            }

            // 4. Handle Neutrons
            for (let i = neutrons.length - 1; i >= 0; i--) {
                let n = neutrons[i];
                n.update();
                n.display();

                if (n.isOffScreen()) {
                    neutrons.splice(i, 1);
                    continue;
                }

                // Collision Detection
                for (let j = atoms.length - 1; j >= 0; j--) {
                    let atom = atoms[j];
                    if (n.hits(atom)) {
                        // FISSION EVENT
                        triggerFission(atom.x, atom.y);
                        atoms.splice(j, 1); // Remove Uranium
                        neutrons.splice(i, 1); // Remove the bullet neutron
                        fissionCount++;
                        break;
                    }
                }
            }

            updateUI();
        }

        function triggerFission(x, y) {
            // 1. Create Shockwave
            shockwaves.push(new Shockwave(x, y));

            // 2. Spawn 2 Daughter Nuclei (Fragments)
            fragments.push(new Fragment(x, y, -1));
            fragments.push(new Fragment(x, y, 1));

            // 3. Spawn 3 New Neutrons (Fast)
            for (let k = 0; k < 3; k++) {
                neutrons.push(new Neutron(x, y, true));
            }
        }

        function fireNeutron() {
            if (!reactionTriggered) {
                let n = new Neutron(0, height / 2, false);
                n.vel = createVector(6, 0); // Straight shot
                neutrons.push(n);
                reactionTriggered = true;
            }
        }

        function resetSim() {
            atoms = [];
            neutrons = [];
            fragments = [];
            shockwaves = [];
            reactionTriggered = false;
            fissionCount = 0;

            // Create Grid of Uranium
            let cols = 10;
            let rows = 6;
            let spacing = 60;
            let startX = width/2 - (cols*spacing)/2;
            let startY = height/2 - (rows*spacing)/2;

            for (let i = 0; i < cols; i++) {
                for (let j = 0; j < rows; j++) {
                    // Slight random offset for realism
                    let x = startX + i * spacing + random(-5, 5);
                    let y = startY + j * spacing + random(-5, 5);
                    atoms.push(new Uranium(x, y));
                }
            }
        }

        function updateUI() {
            document.getElementById('n-count').innerText = neutrons.length;
            document.getElementById('u-count').innerText = atoms.length;
            
            let energyText = "Low";
            if (fissionCount > 5) energyText = "Medium";
            if (fissionCount > 20) energyText = "CRITICAL (High)";
            document.getElementById('e-count').innerText = energyText;
            
            if(fissionCount > 20) {
                 document.getElementById('e-count').style.color = "#ff4757";
            } else {
                 document.getElementById('e-count').style.color = "#ffeb3b";
            }
        }

        // --- CLASSES ---

        class Uranium {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.r = 25;
            }
            display() {
                // Glow Effect
                drawingContext.shadowBlur = 15;
                drawingContext.shadowColor = 'rgba(0, 212, 255, 0.5)';
                
                fill(0, 100, 200); // Blue Uranium
                stroke(100, 200, 255);
                strokeWeight(2);
                ellipse(this.x + random(-1,1), this.y + random(-1,1), this.r * 2); // Wiggle slightly
                
                drawingContext.shadowBlur = 0; // Reset
            }
        }

        class Fragment {
            constructor(x, y, dir) {
                this.pos = createVector(x, y);
                this.vel = p5.Vector.random2D().mult(2);
                // Push them apart generally
                this.vel.x += dir * 1; 
                this.r = 15;
            }
            update() {
                this.pos.add(this.vel);
                this.vel.mult(0.98); // Friction
            }
            display() {
                drawingContext.shadowBlur = 10;
                drawingContext.shadowColor = 'orange';
                fill(255, 100, 0); // Orange/Red Fragment
                noStroke();
                ellipse(this.pos.x, this.pos.y, this.r * 2);
                drawingContext.shadowBlur = 0;
            }
        }

        class Neutron {
            constructor(x, y, isProduct) {
                this.pos = createVector(x, y);
                this.r = 4;
                if (isProduct) {
                    this.vel = p5.Vector.random2D().mult(random(4, 7)); // Fast explosion
                } else {
                    this.vel = createVector(0, 0);
                }
                this.trail = [];
            }
            update() {
                this.trail.push(this.pos.copy());
                if (this.trail.length > 5) this.trail.shift();
                
                this.pos.add(this.vel);
            }
            display() {
                // Trail
                noStroke();
                for (let i = 0; i < this.trail.length; i++) {
                    let alpha = map(i, 0, this.trail.length, 0, 200);
                    fill(255, 255, 255, alpha);
                    ellipse(this.trail[i].x, this.trail[i].y, this.r * 1.5);
                }

                // Head
                drawingContext.shadowBlur = 10;
                drawingContext.shadowColor = 'white';
                fill(255);
                ellipse(this.pos.x, this.pos.y, this.r * 2);
                drawingContext.shadowBlur = 0;
            }
            isOffScreen() {
                return (this.pos.x < 0 || this.pos.x > width || this.pos.y < 0 || this.pos.y > height);
            }
            hits(atom) {
                let d = dist(this.pos.x, this.pos.y, atom.x, atom.y);
                return d < atom.r + this.r;
            }
        }

        class Shockwave {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.r = 10;
                this.alpha = 255;
            }
            update() {
                this.r += 8; // Expand fast
                this.alpha -= 10; // Fade out
            }
            display() {
                noFill();
                stroke(255, 255, 200, this.alpha);
                strokeWeight(3);
                ellipse(this.x, this.y, this.r * 2);
            }
            done() {
                return this.alpha <= 0;
            }
        }
        
        function windowResized() {
             resizeCanvas(windowWidth, windowHeight - 100);
             resetSim();
        }
    </script>
</body>
</html>